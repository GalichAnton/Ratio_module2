const z=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))c(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const v of i.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&c(v)}).observe(document,{childList:!0,subtree:!0});function t(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerpolicy&&(i.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?i.credentials="include":l.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function c(l){if(l.ep)return;l.ep=!0;const i=t(l);fetch(l.href,i)}};z();const a={size:5,colors:["#c3f3c7","#a9e8b0","#9edba4","#76c47e","#71bd79","#67e174","#61ad69","#499e51","#418c48","#34783a"]},o={canPressDown:!0,canPressUp:!0,canPressLeft:!0,canPressRight:!0},r={interval:0,milliSeconds:0,seconds:0,minutes:0},k=e=>{switch(e){case 2:return a.colors[0];case 4:return a.colors[1];case 8:return a.colors[2];case 16:return a.colors[3];case 32:return a.colors[4];case 64:return a.colors[5];case 256:return a.colors[6];case 512:return a.colors[7];case 1024:return a.colors[8];case 2048:return a.colors[9];default:return}},G=(e,n)=>{for(let t=0;t<n*n;t++){const c=document.createElement("div");c.classList.add("game__cell-wrapper"),e.append(c)}},O=e=>{const n=document.createElement("div");return n.classList.add("game__cell"),n.style.backgroundColor=k(e),n.textContent=String(e),n},j=()=>Math.random()>.1?2:4,L=document.querySelector(".game__table"),_=document.querySelector(".game__end"),x=document.querySelector(".btn__start"),b=document.querySelector(".end"),X=document.querySelector(".game__again"),Y=document.querySelector("#no"),E=document.querySelector(".game__win"),N=document.querySelector(".game__win-button"),q=document.querySelector(".game__win-input"),B=document.querySelector(".result__table"),P=document.querySelector("#minutes"),f=document.querySelector("#seconds"),w=document.querySelector("#milliseconds"),D=()=>{for(let e=0;e<a.size;e++)for(let n=0;n<a.size;n++){const t=document.querySelector(`#x${e}y${n}`);t&&t.remove()}r.seconds=0,f.textContent="0"+r.seconds,r.minutes=0,P.textContent="0"+r.minutes,r.milliSeconds=0,w.textContent="0"+r.milliSeconds,_.classList.remove("game__end-active"),x.removeAttribute("disabled"),b.setAttribute("disabled","true")},H=()=>{B.insertAdjacentHTML("beforeend",`<li class="result__item">
          <span class="result__name">${q.value}</span>|
          <span class="result__score">${Math.ceil(2048/(r.minutes*60+r.seconds))}</span>
          </li>`),q.value="",E.classList.remove("game__win-active"),D()},F=()=>{clearInterval(r.interval),E.classList.add("game__win-active"),o.canPressDown=!1,o.canPressUp=!1,o.canPressRight=!1,o.canPressLeft=!1,N.addEventListener("click",H)},d=(e,n,t)=>{const c=document.querySelector(`#x${t}y${n}`);c&&(c.remove(),e.textContent=String(+e.textContent*2),e.style.backgroundColor=k(+e.textContent)),e.textContent==="2048"&&F(),e.style.left=n*20+"%",e.style.top=t*20+"%",e.id=`x${t}y${n}`},W=e=>{let n,t,c=0;do if(n=Math.floor(Math.random()*a.size),t=Math.floor(Math.random()*a.size),++c===50)return;while(s[t][n]);return d(e,n,t),s[t][n]=Number(e.textContent),e},u=()=>{const e=W(O(j()));!e||L.append(e)},K=e=>{const n=new Array(e);for(let t=0;t<e;t++){n[t]=new Array(e);for(let c=0;c<e;c++)n[t][c]=0}return n},J=()=>{o.canPressLeft=!1;for(let e=0;e<a.size;e++)for(let n=1;n<a.size;n++)if(s[e][n]){let t=n;for(;t!=0;){if(s[e][t-1]===s[e][t]){s[e][t-1]=s[e][t-1]+s[e][t],s[e][t]=0;const c=document.querySelector(`#x${e}y${t}`);d(c,t-1,e),o.canPressLeft=!0}else if(s[e][t-1]===0){const c=document.querySelector(`#x${e}y${t}`);s[e][t-1]=s[e][t],s[e][t]=0,d(c,t-1,e),o.canPressLeft=!0}t--}}},M=()=>{new Promise(e=>{o.canPressDown&&(J(),e())}).then(()=>{u(),u()})},Q=()=>{o.canPressUp=!1;for(let e=0;e<a.size;e++)for(let n=1;n<a.size;n++)if(s[n][e]){let t=n;for(;t!=0;){if(s[t-1][e]===s[t][e]){s[t-1][e]=s[t-1][e]+s[t][e],s[t][e]=0;const c=document.querySelector(`#x${t}y${e}`);d(c,e,t-1),o.canPressUp=!0}else if(s[t-1][e]===0){s[t-1][e]=s[t][e],s[t][e]=0;const c=document.querySelector(`#x${t}y${e}`);d(c,e,t-1),o.canPressUp=!0}t--}}},R=()=>{new Promise(e=>{o.canPressDown&&(Q(),e())}).then(()=>{u(),u()})},V=()=>{o.canPressDown=!1;for(let e=4;e>=0;e--)for(let n=3;n>=0;n--)if(s[n][e]){let t=n;for(;t!=4;){if(s[t+1][e]===s[t][e]){s[t+1][e]=s[t+1][e]+s[t][e],s[t][e]=0;const c=document.querySelector(`#x${t}y${e}`);d(c,e,t+1),o.canPressDown=!0}else if(s[t+1][e]===0){const c=document.querySelector(`#x${t}y${e}`);s[t+1][e]=s[t][e],s[t][e]=0,d(c,e,t+1),o.canPressDown=!0}t++}}},T=()=>{new Promise(e=>{o.canPressDown&&(V(),e())}).then(()=>{u(),u()})},Z=()=>{o.canPressRight=!1;for(let e=4;e>=0;e--)for(let n=3;n>=0;n--)if(s[e][n]){let t=n;for(;t!=4;){if(s[e][t+1]===s[e][t]){s[e][t+1]=s[e][t+1]+s[e][t],s[e][t]=0;const c=document.querySelector(`#x${e}y${t}`);d(c,t+1,e),o.canPressRight=!0}else if(s[e][t+1]===0){s[e][t+1]=s[e][t],s[e][t]=0;const c=document.querySelector(`#x${e}y${t}`);d(c,t+1,e),o.canPressRight=!0}t++}}},A=()=>{new Promise(e=>{o.canPressDown&&(Z(),e())}).then(()=>{u(),u()})},ee=e=>{switch(e.key){case"ArrowLeft":e.preventDefault(),M();break;case"ArrowUp":e.preventDefault(),R();break;case"ArrowDown":e.preventDefault(),T();break;case"ArrowRight":e.preventDefault(),A();break}},te=()=>{D(),_.classList.remove("game__end-active"),I()},U=()=>{clearInterval(r.interval),_.classList.add("game__end-active"),X.addEventListener("click",te),Y.addEventListener("click",D),o.canPressDown=!1,o.canPressUp=!1,o.canPressRight=!1,o.canPressLeft=!1},ne=()=>{!o.canPressLeft&&!o.canPressRight&&!o.canPressDown&&!o.canPressUp&&U()},se=()=>{r.milliSeconds++,r.milliSeconds<9&&(w.textContent="0"+r.milliSeconds),r.milliSeconds>9&&(w.textContent=String(r.milliSeconds)),r.milliSeconds>99&&(r.seconds++,f.textContent="0"+r.seconds,r.milliSeconds=0,w.textContent="0"+r.milliSeconds),r.seconds<=9&&(f.textContent="0"+r.seconds),r.seconds>9&&(f.textContent=String(r.seconds)),r.seconds>59&&(r.minutes++,P.textContent="0"+r.minutes,r.seconds=0,f.textContent="0"+r.seconds),r.minutes>9&&(P.textContent=String(r.minutes))};let s=[];const I=()=>{s=K(a.size),u(),u(),document.addEventListener("keydown",e=>{ee(e),ne()}),r.interval=setInterval(se,10),x.setAttribute("disabled","true"),b.removeAttribute("disabled"),o.canPressDown=!0,o.canPressUp=!0,o.canPressRight=!0,o.canPressLeft=!0},re=250,oe=40,ce=100;let g=0,S=0,y=0,h=0,p=0,m=0,C=0;const ae=e=>{e.addEventListener("mousedown",function(n){g=new Date().getTime(),y=n.pageX,h=n.pageY,n.preventDefault()}),e.addEventListener("mouseup",function(n){n.preventDefault(),S=new Date().getTime()-g,p=n.pageX-y,m=n.pageY-h,$()}),e.addEventListener("touchstart",function(n){g=new Date().getTime(),y=n.touches[0].pageX,h=n.touches[0].pageY,n.preventDefault()}),e.addEventListener("touchend",function(n){S=new Date().getTime()-g,console.log(n),p=n.changedTouches[0].pageX-y,m=n.changedTouches[0].pageY-h,$(),n.preventDefault()})},$=()=>{C=Math.sqrt(Math.pow(p,2)+Math.pow(m,2)),S<=re&&C>=oe&&(Math.abs(m)<=ce&&Math.abs(p)>Math.abs(m)?p>0?A():M():m>0?T():R())};G(L,a.size);x.addEventListener("click",()=>{I()});b.addEventListener("click",()=>{U()});ae(L);
